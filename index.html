<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Activity_04</title>
</head>
<body>
		<h2>Computer Retailer - Product Management</h2>
		<input type="text" id="name" placeholder="Enter product name" required>
		<input type="number" id="price" placeholder="Enter product price">
		<select id="category">
			<option value="">Select category</option>
			<option>Laptop</option>
			<option>Desktop</option>
			<option>Accessories</option>
		</select>
		<button onclick="app.save()">Submit</button>

		<h3>Search Products</h3>
		<input type="text" id="search" placeholder="Search by name or category" oninput="app.search()">

		<hr>
		<table width='100%' border=1>
			<thead>
				<tr>
					<td>Product Name</td>
					<td>Price</td>
					<td>Category</td>
					<td>Action</td>
				</tr>
			</thead>
			<tbody id="tbdata"></tbody>
		</table>

        <script src="node_modules/sweetalert/dist/sweetalert.min.js"></script>
        
        
        <script>
            class ProductApp {
                constructor() {
                    this.data = [];  // Store products
                    this.id = '';  // To track edit mode
                }
        
                save() {
                    var name = document.getElementById('name').value.trim();
                    var price = document.getElementById('price').value;
                    var category = document.getElementById('category').value;
                
                    // Validation to prevent empty inputs
                    if (!name || !price || !category) {
                        swal("Error", "All fields are required!", "error");
                        return;
                    }
                
                    if (this.id === '') {
                        // Add new product
                        this.data.push([name, price, category]);
                        swal("Success", "Product added successfully!", "success");
                    } else {
                        // Update existing product
                        this.data[this.id][0] = name; // Update the name
                        this.data[this.id][1] = price; // Update the price
                        this.data[this.id][2] = category; // Update the category
                        this.id = '';  // Clear id after update
                        swal("Success", "Product updated successfully!", "success");
                    }
                
                    this.view(); // Call view after adding or updating
                    this.clear(); // Clear input fields
                }
                

                view(dataToDisplay = this.data) {
                    // Show products
                    let datatable = '';
                    for (let i = 0; i < dataToDisplay.length; i++) {
                        datatable += `<tr>
                            <td>${dataToDisplay[i][0]}</td>
                            <td>â‚± ${dataToDisplay[i][1]}</td>
                            <td>${dataToDisplay[i][2]}</td>
                            <td>
                                <button onclick="app.edit(${i})">Edit</button>
                                <button onclick="app.del(${i})">Delete</button>
                            </td>
                        </tr>`;
                    }
                    document.getElementById('tbdata').innerHTML = datatable;
                }
        
                edit(i) {
                    // Edit a product
                    this.id = i;  // Set id to track the index of the product to edit
                    document.getElementById('name').value = this.data[i][0];
                    document.getElementById('price').value = this.data[i][1];
                    document.getElementById('category').value = this.data[i][2];
                }
        
                del(i) {
                    // Delete a product with SweetAlert confirmation
                    swal({
                        title: "Are you sure?",
                        text: "Once deleted, you will not be able to recover this product!",
                        icon: "warning",
                        buttons: true,
                        dangerMode: true,
                    }).then((willDelete) => {
                        if (willDelete) {
                            this.data.splice(i, 1);
                            this.view();
                            swal("Deleted!", "Product has been deleted!", "success");
                        }
                    });
                }
        
                clear() {
                    // Clear input fields
                    document.getElementById('name').value = '';
                    document.getElementById('price').value = '';
                    document.getElementById('category').value = '';
                    this.id = '';  // Clear the edit mode identifier
                }
        
                search() {
                    // Search for products by name or category
                    const searchValue = document.getElementById('search').value.trim().toLowerCase();
                    const filteredData = this.data.filter(product => 
                        product[0].toLowerCase().includes(searchValue) || 
                        product[2].toLowerCase().includes(searchValue)
                    );
                    this.view(filteredData);
                }
            }
        
            // Instantiate the ProductApp class
            const app = new ProductApp();
        </script>
	</body>
</html>
